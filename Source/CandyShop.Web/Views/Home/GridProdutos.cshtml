@using CandyShop.Web.Helpers
@model IEnumerable<CandyShop.Application.ViewModels.ProdutoViewModel>

@{ Layout = null; }

<style>
    img {
        max-width: 100%;
    }

    body {
        overflow-y: scroll !important;
    }
</style>

<script>
    $(document).ready(function () {
        $('.tooltipped').tooltip({ delay: 50 });
        // Exibindo quantidade em estoque nos modals de quantidade
        // Exibindo qtde em estoque antes de adicionar o item no carrinho
        $(".adicionaItemCarrinho").click(function () {
            // Limpando os inputs
            $("#quantidade").val("");
            // Mostrando a quantidade de produto dispónível em estoque
            var quantidadeDisponivel = $(this).attr('data-quantidadeDisponivel');
            $('#modalQuantidade div p').html("Quantidade disponível em estoque: " + quantidadeDisponivel);
        });
    });
</script>


<div class="row">
    @if (!Model.Any())
    {
        <b><p align="center">Nenhum produto encontrado para '@ViewBag.Produto'</p></b>
    }
    else
    {
        foreach (var produto in Model)
        {
            <div class="col s12 m4 l2">
                <div class="card">
                    <div class="card-image">
                        @{ string nomeA = produto.IdProduto + "_A.jpg";}
                        <img src="@Html.UrlContent(TempData["caminhoImagensProdutos"], nomeA)">
                        <span class="card-title flow-text">@produto.NomeProduto</span>
                        <a href="#modalQuantidade" id="abreModal"
                           class="modal-trigger btn-floating halfway-fab waves-effect waves-light pink lighten-1 tooltipped adicionaItemCarrinho"
                           data-position="bottom" data-delay="50"
                           data-tooltip="@(produto.QtdeProduto == 0 ? "Produto indisponível no estoque" + produto.NomeProduto : "R$ " + produto.PrecoProduto)"
                           data-Preco="@produto.PrecoProduto"
                           data-Nome="@produto.NomeProduto"
                           data-Id="@produto.IdProduto"
                           data-Imagem="@Html.UrlContent(TempData["caminhoImagensProdutos"], nomeA)"
                           data-quantidadeDisponivel="@produto.QtdeProduto"
                           @(produto.QtdeProduto == 0 ? "disabled" : string.Empty)>
                            <i class="material-icons">add</i>
                        </a>
                    </div>
                    <div class="card-content">
                        <p>R$ @Html.DisplayFor(model => produto.PrecoProduto)</p>
                    </div>
                </div>
            </div>
                                }
                            }
</div>

